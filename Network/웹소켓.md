**Q. 웹 소켓이란?**

**두 프로그램 간**의 **메시지**를 교환하기 위한 통신 방법 중 하나이다.

현재 인터넷 환경 (HTML5) 에서 많이 사용된다.

1. 소켓을 만든다.
2. 서버측의 소켓에 파이프를 연결한다.
3. 데이터를 송수신한다.
4. 파이프를 분리하고, 소켓을 말소한다.

**Q. 웹 소켓의 특징**

1. 양방향 통신 (클라이언트와 서버가 서로 원할 때 데이터를 주고 받을 수 있다)
2. 실시간 네트워킹 (웹 환경에서 연속된 데이터를 빠르게 노출)

**Q. 웹 소켓 이전의 유사한 기술**

Polling : 클라이언트에서 일정한 주기로 request 를 보내며, 서버에서는 데이터가 존재하면 전송하고 아니면 실패와 같은 메세지를 전달합니다.

Longpolling : Polling 의 단점을 보완하기 위해 서버에서 일정 시간 대기를 하며 이벤트가 발생시 클라이언트에게 전송하는 방식입니다. 하지만 이벤트가 많은 경우 폴링과 크게 다르지 않다는 한계가 있습니다.

Server-Sent Event: HTTP 를 사용해 서버 푸쉬를 구현한 방식입니다. 서버에서 지속적으로 클라이언트와의 연결을 유지한채 이벤트를 전송합니다. 클라이언트에서 서버로의 요청이 불가능한 단방향 통신입니다.

모든 방법이 HTTP 프로토콜을 사용하기 때문에 Request, Respone 의 큰 헤더가 단점입니다.

**Q. 웹 소켓의 동작 방법**

**핸드쉐이크**

HTTP 프로토콜을 사용해 이루어집니다. HTTP 1.1 이상, get 메서드 사용해야 합니다.

upgrade 헤더에 websocket 명시, 다른 프로토콜로의 변경을 의미합니다. Sec-Websocket-key 를 통해 신원을 인증합니다.

**데이터 전송**

ws 프로토콜을 사용합니다. wss 데이터 보안을 위해 SSL(TLS) 를 적용한 프로토콜입니다. 메세지라는 단위를 사용하며, 여러 frame 이 모여서 구성하나는 하나의 논리적 메세지 단위입니다. frame 은 가장 작은 단위의 데이터이며 작은 헤더와 페이로드로 구성되어있습니다. 이 작은 헤더를 통해 HTTP 통신에서의 헤더에 대한 오버헤드를 줄일 수 있습니다.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d27d4138-765a-43b5-81cc-bcf97b25e815/Untitled.png)

**Q. 웹 소켓 프로토콜의 특징**

최초 접속에서만 HTTP 프로토콜 위에서 HandShaking 하기 때문에 HTTP Header 를 사용합니다. 웹소켓을 위한 별도의 포트가 없으며, 프레임으로 구성된 메시지라는 논리적 단위로 송수신합니다. 이 때 메세지에 포함할 수 있는 타입은 `텍스트`와 `바이너리`입니다.

**Q. 웹 소켓의 한계**

HTML5 이후에 나온 기술이기 때문에 이전의 기술로 구현된 서비스에 대한 적용이 어렵습니다. 이를 Socket IO 를 활용해 해결할 수 있습니다. 이는 여러 기술을 하나의 API 로 추상화하고, 브라우저와 웹 서버의 종류에 가장 적합한 기술을 선택하여 웹 소켓처럼 보여지게 폴백합니다.

폴백 : 동일한 결과를 얻기 위해 여러 가지 메커니즘을 사용합니다.

**Q. STOMP**

웹 소켓은 문자열들을 주고 받을 수 있게 합니다. 문자열 해독은 어플리케이션이 하며, 형식이 정해져있지 않기 때문에 어플리케이션에서 해석하는게 어렵습니다. Sub-Protocol 을 통해 주고 받는 메시지의 형태를 약속합니다. 이 중 자주 사용하는 프로코롤로 STOMP 가 있습니다.
